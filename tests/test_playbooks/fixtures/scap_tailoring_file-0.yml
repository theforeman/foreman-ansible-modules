interactions:
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/status
  response:
    body:
      string: '{"result":"ok","status":200,"version":"1.24.2","api_version":2}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '63'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data: *.gravatar.com; script-src ''unsafe-eval'' ''unsafe-inline''
        ''self''; style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Date:
      - Thu, 26 Mar 2020 19:23:49 GMT
      ETag:
      - W/"39b73f2292fd196be82f6d5e7da4a321"
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 1.24.2
      Keep-Alive:
      - timeout=5, max=10000
      Server:
      - Apache
      Set-Cookie:
      - _session_id=d7928b42c2afe5c6f294d6ba5b22d47a; path=/; secure; HttpOnly; SameSite=Lax
      Status:
      - 200 OK
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-Powered-By:
      - Phusion Passenger 4.0.53
      X-Request-Id:
      - 50db4c3c-fea1-41f8-9d24-76843d049a6b
      X-Runtime:
      - '0.103613'
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      Cookie:
      - _session_id=d7928b42c2afe5c6f294d6ba5b22d47a
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/compliance/tailoring_files?search=name%3D%22scap_tailoring_file_name%22&per_page=4294967296
  response:
    body:
      string: "{\n  \"total\": 0,\n  \"subtotal\": 0,\n  \"page\": 1,\n  \"per_page\"\
        : 4294967296,\n  \"search\": \"name=\\\"scap_tailoring_file_name\\\"\",\n  \"sort\"\
        : {\n    \"by\": null,\n    \"order\": null\n  },\n  \"results\": []\n}\n"
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data: *.gravatar.com; script-src ''unsafe-eval'' ''unsafe-inline''
        ''self''; style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Date:
      - Thu, 26 Mar 2020 19:23:49 GMT
      ETag:
      - W/"f5fe6779bd397fd8702b2b6e64355f6d-gzip"
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 1.24.2
      Keep-Alive:
      - timeout=5, max=9999
      Server:
      - Apache
      Status:
      - 200 OK
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      Vary:
      - Accept-Encoding
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-Powered-By:
      - Phusion Passenger 4.0.53
      X-Request-Id:
      - 2ccb42ec-f8b4-4805-9571-c606a7f858c8
      X-Runtime:
      - '0.017545'
      X-XSS-Protection:
      - 1; mode=block
      content-length:
      - '185'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      Cookie:
      - _session_id=d7928b42c2afe5c6f294d6ba5b22d47a
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/katello/api/organizations?search=name%3D%22Test+Organization%22&per_page=4294967296
  response:
    body:
      string: "{\n  \"total\": 2,\n  \"subtotal\": 1,\n  \"page\": 1,\n  \"per_page\"\
        : 4294967296,\n  \"search\": \"name=\\\"Test Organization\\\"\",\n  \"sort\"\
        : {\n    \"by\": null,\n    \"order\": null\n  },\n  \"results\": [{\"label\"\
        :\"Test_Organization\",\"created_at\":\"2020-03-26 19:23:41 UTC\",\"updated_at\"\
        :\"2020-03-26 19:23:41 UTC\",\"id\":26,\"name\":\"Test Organization\",\"title\"\
        :\"Test Organization\",\"description\":\"A test organization\"}]\n}\n"
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data: *.gravatar.com; script-src ''unsafe-eval'' ''unsafe-inline''
        ''self''; style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Date:
      - Thu, 26 Mar 2020 19:23:49 GMT
      ETag:
      - W/"6de21db9bcaae953a94be31ce0035b36-gzip"
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 1.24.2
      Keep-Alive:
      - timeout=5, max=9998
      Server:
      - Apache
      Status:
      - 200 OK
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      Vary:
      - Accept-Encoding
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-Powered-By:
      - Phusion Passenger 4.0.53
      X-Request-Id:
      - 4160f194-6843-444b-9141-81741c57993f
      X-Runtime:
      - '0.019843'
      X-XSS-Protection:
      - 1; mode=block
      content-length:
      - '389'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      Cookie:
      - _session_id=d7928b42c2afe5c6f294d6ba5b22d47a
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/locations?search=title%3D%22Test+Location%22&per_page=4294967296
  response:
    body:
      string: "{\n  \"total\": 3,\n  \"subtotal\": 1,\n  \"page\": 1,\n  \"per_page\"\
        : 4294967296,\n  \"search\": \"title=\\\"Test Location\\\"\",\n  \"sort\"\
        : {\n    \"by\": null,\n    \"order\": null\n  },\n  \"results\": [{\"ancestry\"\
        :null,\"parent_id\":null,\"parent_name\":null,\"created_at\":\"2020-03-26\
        \ 19:23:46 UTC\",\"updated_at\":\"2020-03-26 19:23:46 UTC\",\"id\":27,\"name\"\
        :\"Test Location\",\"title\":\"Test Location\",\"description\":null}]\n}\n"
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data: *.gravatar.com; script-src ''unsafe-eval'' ''unsafe-inline''
        ''self''; style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Date:
      - Thu, 26 Mar 2020 19:23:49 GMT
      ETag:
      - W/"4051f7631d44db9f173e7aa5746e2d28-gzip"
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 1.24.2
      Keep-Alive:
      - timeout=5, max=9997
      Server:
      - Apache
      Status:
      - 200 OK
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      Vary:
      - Accept-Encoding
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-Powered-By:
      - Phusion Passenger 4.0.53
      X-Request-Id:
      - d0f7120c-1095-4ed3-a5fb-8b5cd39e8155
      X-Runtime:
      - '0.019867'
      X-XSS-Protection:
      - 1; mode=block
      content-length:
      - '385'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      Cookie:
      - _session_id=d7928b42c2afe5c6f294d6ba5b22d47a
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/compliance/tailoring_files?search=name%3D%22scap_tailoring_file_name%22&per_page=4294967296
  response:
    body:
      string: "{\n  \"total\": 0,\n  \"subtotal\": 0,\n  \"page\": 1,\n  \"per_page\"\
        : 4294967296,\n  \"search\": \"name=\\\"scap_tailoring_file_name\\\"\",\n  \"sort\"\
        : {\n    \"by\": null,\n    \"order\": null\n  },\n  \"results\": []\n}\n"
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data: *.gravatar.com; script-src ''unsafe-eval'' ''unsafe-inline''
        ''self''; style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Date:
      - Thu, 26 Mar 2020 19:23:49 GMT
      ETag:
      - W/"f5fe6779bd397fd8702b2b6e64355f6d-gzip"
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 1.24.2
      Keep-Alive:
      - timeout=5, max=9996
      Server:
      - Apache
      Status:
      - 200 OK
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      Vary:
      - Accept-Encoding
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-Powered-By:
      - Phusion Passenger 4.0.53
      X-Request-Id:
      - 566c7912-3ba2-4dfe-a252-7713f0c3d3dd
      X-Runtime:
      - '0.018093'
      X-XSS-Protection:
      - 1; mode=block
      content-length:
      - '185'
    status:
      code: 200
      message: OK
- request:
    body: '{"tailoring_file": {"name": "scap_tailoring_file_name", "scap_file": "<?xml
      version=\"1.0\" encoding=\"UTF-8\"?>\n<xccdf:Tailoring xmlns:xccdf=\"http://checklists.nist.gov/xccdf/1.2\"
      id=\"xccdf_scap-workbench_tailoring_default\">\n  <xccdf:benchmark href=\"/tmp/scap-workbench-nlKqUD/ssg-firefox-ds.xml\"/>\n  <xccdf:version
      time=\"2020-03-26T20:20:49\">1</xccdf:version>\n  <xccdf:Profile id=\"xccdf_org.theforeman_profile_fam_test_fixtures\"
      extends=\"xccdf_org.ssgproject.content_profile_stig\">\n    <xccdf:title xmlns:xhtml=\"http://www.w3.org/1999/xhtml\"
      xml:lang=\"en-US\" override=\"true\">Upstream Firefox STIG [CUSTOMIZED]</xccdf:title>\n    <xccdf:description
      xmlns:xhtml=\"http://www.w3.org/1999/xhtml\" xml:lang=\"en-US\" override=\"true\">This
      profile is developed under the DoD consensus model and DISA FSO Vendor STIG
      process,\nserving as the upstream development environment for the Firefox STIG.\n\nAs
      a result of the upstream/downstream relationship between the SCAP Security Guide
      project\nand the official DISA FSO STIG baseline, users should expect variance
      between SSG and DISA FSO content.\nFor official DISA FSO STIG content, refer
      to https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=app-security%2Cbrowser-guidance.\n\nWhile
      this profile is packaged by Red Hat as part of the SCAP Security Guide package,
      please note\nthat commercial support of this SCAP content is NOT available.
      This profile is provided as example\nSCAP content with no endorsement for suitability
      or production readiness. Support for this\nprofile is provided by the upstream
      SCAP Security Guide community on a best-effort basis. The\nupstream project
      homepage is https://www.open-scap.org/security-policies/scap-security-guide/.</xccdf:description>\n    <xccdf:select
      idref=\"xccdf_org.ssgproject.content_rule_firefox_preferences-home_page\" selected=\"false\"/>\n  </xccdf:Profile>\n</xccdf:Tailoring>\n",
      "original_filename": "scap_file_name.xml", "location_ids": [27], "organization_ids":
      [26]}}'
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      Content-Length:
      - '2001'
      Content-Type:
      - application/json
      Cookie:
      - _session_id=d7928b42c2afe5c6f294d6ba5b22d47a
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: POST
    uri: https://foreman.example.org/api/compliance/tailoring_files
  response:
    body:
      string: '{"id":1,"name":"scap_tailoring_file_name","scap_file":"\u003c?xml version=\"1.0\"
        encoding=\"UTF-8\"?\u003e\n\u003cxccdf:Tailoring xmlns:xccdf=\"http://checklists.nist.gov/xccdf/1.2\"
        id=\"xccdf_scap-workbench_tailoring_default\"\u003e\n  \u003cxccdf:benchmark
        href=\"/tmp/scap-workbench-nlKqUD/ssg-firefox-ds.xml\"/\u003e\n  \u003cxccdf:version
        time=\"2020-03-26T20:20:49\"\u003e1\u003c/xccdf:version\u003e\n  \u003cxccdf:Profile
        id=\"xccdf_org.theforeman_profile_fam_test_fixtures\" extends=\"xccdf_org.ssgproject.content_profile_stig\"\u003e\n    \u003cxccdf:title
        xmlns:xhtml=\"http://www.w3.org/1999/xhtml\" xml:lang=\"en-US\" override=\"true\"\u003eUpstream
        Firefox STIG [CUSTOMIZED]\u003c/xccdf:title\u003e\n    \u003cxccdf:description
        xmlns:xhtml=\"http://www.w3.org/1999/xhtml\" xml:lang=\"en-US\" override=\"true\"\u003eThis
        profile is developed under the DoD consensus model and DISA FSO Vendor STIG
        process,\nserving as the upstream development environment for the Firefox
        STIG.\n\nAs a result of the upstream/downstream relationship between the SCAP
        Security Guide project\nand the official DISA FSO STIG baseline, users should
        expect variance between SSG and DISA FSO content.\nFor official DISA FSO STIG
        content, refer to https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=app-security%2Cbrowser-guidance.\n\nWhile
        this profile is packaged by Red Hat as part of the SCAP Security Guide package,
        please note\nthat commercial support of this SCAP content is NOT available.
        This profile is provided as example\nSCAP content with no endorsement for
        suitability or production readiness. Support for this\nprofile is provided
        by the upstream SCAP Security Guide community on a best-effort basis. The\nupstream
        project homepage is https://www.open-scap.org/security-policies/scap-security-guide/.\u003c/xccdf:description\u003e\n    \u003cxccdf:select
        idref=\"xccdf_org.ssgproject.content_rule_firefox_preferences-home_page\"
        selected=\"false\"/\u003e\n  \u003c/xccdf:Profile\u003e\n\u003c/xccdf:Tailoring\u003e","original_filename":"scap_file_name.xml","created_at":"2020-03-26T19:23:50.269Z","updated_at":"2020-03-26T19:23:50.269Z","digest":"aee87964df5292740fbad9887775d370f42f9e99db5a109cd559880b689328c9"}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data: *.gravatar.com; script-src ''unsafe-eval'' ''unsafe-inline''
        ''self''; style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Date:
      - Thu, 26 Mar 2020 19:23:49 GMT
      ETag:
      - W/"4ca0313062890f69d2c36988f5bb87ad"
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 1.24.2
      Keep-Alive:
      - timeout=5, max=9995
      Location:
      - https://centos7-katello-3-14.yatsu.example.com/compliance/tailoring_files/1
      Server:
      - Apache
      Set-Cookie:
      - request_method=POST; path=/; secure; HttpOnly; SameSite=Lax
      Status:
      - 201 Created
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      Transfer-Encoding:
      - chunked
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-Powered-By:
      - Phusion Passenger 4.0.53
      X-Request-Id:
      - 145e5ad3-ce40-4c6f-8e0b-1141f84920c2
      X-Runtime:
      - '0.665959'
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 201
      message: Created
version: 1
