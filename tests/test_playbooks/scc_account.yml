---
- hosts: fixtures
  gather_facts: false
  vars_files:
    - vars/server.yml
  tasks:
    - include: tasks/scc_account.yml
      vars:
        scc_account_name: 'Test'
        organization_name: 'Default Organization'
        scc_account_state: absent
    - include: tasks/scc_account.yml
      vars:
        scc_account_name: 'Test2'
        organization_name: 'Default Organization'
        scc_account_state: absent
- hosts: tests
  gather_facts: false
  vars_files:
    - vars/server.yml
  tasks:
  - include: tasks/scc_account.yml
    vars:
      scc_account_password: 'testpass'
      scc_account_base_url: 'https://scc.suse.com'
      scc_account_state: present
      expected_change: true

  - include: tasks/scc_account.yml
    vars:
      scc_account_state: present
      expected_change: false

  - include: tasks/scc_account.yml
    vars:
      scc_account_name: 'Test'
      scc_account_updated_name: 'Test2'
      scc_account_interval: 'monthly'
      scc_account_state: present
      expected_change: true

  - include: tasks/scc_account.yml
    vars:
      scc_account_name: 'Test2'
      scc_account_interval: 'monthly'
      scc_account_state: present
      expected_change: false

  - include: tasks/scc_account.yml
    vars:
      scc_account_name: 'Test2'
      scc_account_state: sync
      expected_change: true

  - include: tasks/scc_account.yml
    vars:
      scc_account_name: 'Test2'
      scc_account_login: 'testuser'
      scc_account_password: 'testpass'
      scc_account_state: test_connection
      expected_change: true
  - pause: seconds=5

  - include: tasks/scc_account.yml
    vars:
      scc_account_name: 'Test2'
      organization_name: 'Default Organization'
      scc_account_state: absent
      expected_change: true

  - include: tasks/scc_account.yml
    vars:
      scc_account_name: 'Test2'
      organization_name: 'Default Organization'
      scc_account_state: absent
      expected_change: false

