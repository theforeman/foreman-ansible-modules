

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>theforeman.foreman.activation_keys &mdash; Foreman Ansible Modules  documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/ansible-basic-sphinx-ext.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> Foreman Ansible Modules
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">User documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../README.html">Foreman Ansible Modules </a></li>
<li class="toctree-l1"><a class="reference internal" href="../README.html#foreman-ansible-roles">Foreman Ansible Roles</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CHANGELOG.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../plugins/index.html">Theforeman.Foreman</a></li>
<li class="toctree-l1"><a class="reference internal" href="../filters.html">Filters</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html">Role Index</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cvmanager.html">Migrating from <code class="docutils literal notranslate"><span class="pre">cvmanager</span></code> to Foreman Ansible Modules</a></li>
</ul>
<p class="caption"><span class="caption-text">Developer documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../developing.html">How to write modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api.html"><code class="docutils literal notranslate"><span class="pre">foreman_helper</span></code> module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../testing.html">Testing Foreman Ansible Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../releasing.html">Releasing the collection</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Foreman Ansible Modules</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>theforeman.foreman.activation_keys</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/roles/activation_keys.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="theforeman-foreman-activation-keys">
<h1>theforeman.foreman.activation_keys<a class="headerlink" href="#theforeman-foreman-activation-keys" title="Permalink to this headline">¶</a></h1>
<p>This role creates and manages Activation Keys.</p>
<div class="section" id="role-variables">
<h2>Role Variables<a class="headerlink" href="#role-variables" title="Permalink to this headline">¶</a></h2>
<p>This role supports the <a class="reference external" href="https://github.com/theforeman/foreman-ansible-modules/blob/develop/README.md#common-role-variables">Common Role Variables</a>.</p>
<p>The main data structure for this role is the list of <code class="docutils literal notranslate"><span class="pre">activation_keys</span></code>. Each <code class="docutils literal notranslate"><span class="pre">activation_key</span></code> requires the following fields:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code>: The name of the activation key.</p></li>
</ul>
<p>The following fields are required for an activation key but have defaults which make them optional for this role:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">lifecycle_environment</span></code>: Lifecycle Environment to assign to hosts registered with this activation key. Defaults to “Library”.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">content_view</span></code>: Content View to assign to hosts registered with this activation key. Defaults to “Default Organization View”.</p></li>
</ul>
<p>The following fields are optional in the sense that the server will use default values when they are omitted:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">auto_attach</span></code>: Auto Attach behavior for the activation key. When true, it will attempt to attach a minimum of subscriptions (from the subset of assigned subscriptions on the activation key; selects from all subscriptions in the organization if none are assigned) to cover any present products on the host. When false, it will attempt to attach all subscriptions assigned on the activation key to the host at registration time. server defaults to true.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">unlimited_hosts</span></code>: Allow an unlimited number of hosts to register with the activation key when true. When false, the <code class="docutils literal notranslate"><span class="pre">max_hosts</span></code> parameter which sets a numerical limit on the nnumber of hosts that can be registered becomes required. server defaults to true.</p></li>
</ul>
<p>The following fields are optional and will be omitted by default:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">description</span></code>: Description of the activation key. Helpful for other users to find which activation key to use.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">host_collections</span></code>: List of Host Collections to associate with the activation key.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">subscriptions</span></code>: List of Subscriptions to associate with the activation key. Each Subscription is required to have one of <code class="docutils literal notranslate"><span class="pre">name</span></code>, <code class="docutils literal notranslate"><span class="pre">pool_id</span></code>, or <code class="docutils literal notranslate"><span class="pre">upstream_pool_id</span></code>. Of these, only the <code class="docutils literal notranslate"><span class="pre">pool_id</span></code> is guaranteed to be unique. <code class="docutils literal notranslate"><span class="pre">upstream_pool_id</span></code> only exists for subscriptions imported from a 3rd party organization (e.g. on a Red Hat Subscription Manifest). When uniqueness is not an issue, <code class="docutils literal notranslate"><span class="pre">name</span></code> or <code class="docutils literal notranslate"><span class="pre">upstream_pool_id</span></code> can be easier to work with since the <code class="docutils literal notranslate"><span class="pre">pool_id</span></code> does not get determined until the subscription is imported or created and therefore may not yet be determined when you are writing playbooks.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">content_overrides</span></code>: List of Content Overrides for the activation key. Each Content Override is required to have a <code class="docutils literal notranslate"><span class="pre">label</span></code> which refers to a repository and <code class="docutils literal notranslate"><span class="pre">override</span></code> which refers to one of the states enabled, disabled, or default.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">release_version</span></code>: Release Version to set when registering hosts with the activation key.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">service_level</span></code>: Service Level to set when registering hosts with the activation key. Premium, Standard, or Self-Support. This will limit Subscriptions available to hosts to those matching this service level.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">purpose_usage</span></code>: System Purpose Usage to set when registering hosts with the activation key. Production, Development/Test, Disaster Recovery. When left unset this will not set System Purpose Usage on registering hosts. This should only be used when it is supported by the OS of registering hosts (RHEL 8 only at the time of writing).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">purpose_role</span></code>: System Purpose Role to set when registering hosts with the activation key. Red Hat Enterprise Linux Server, Red Hat Enterprise Linux Workstation, Red Hat Enterprise Linux Compute Node. When left unset this will not set System Purpose Role on registering hosts. This should only be used when it is supported by the OS of registering hosts (RHEL 8 only at the time of writing).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">purpose_addons</span></code>: List of System Purpose Addons (ELS, EUS) to set on registering hosts. This should only be used when it is supported by the OS of registering hosts (RHEL 8 only at the time of writing).</p></li>
</ul>
<p>A helpful behavior to keep in mind when creating activation keys is that a host can register with multiple activation keys; each activation key will attach subscriptions according to its own logic, in the order that the activation keys are listed. Host attributes like Lifecycle Environment, Content View, etc will be overwritten by later activation keys so that the last activation key listed wins. A common pattern is to first use an activation key which has auto-attach disabled and a list of subscriptions to attach for any applicable custom products, followed by a second activation key which has auto attach enabled to attach the best fitting subscription(s) for the OS and any remaining products which were not already covered, and also defines the LCE, Content View, and other host attributes as required.</p>
</div>
<div class="section" id="example-playbooks">
<h2>Example Playbooks<a class="headerlink" href="#example-playbooks" title="Permalink to this headline">¶</a></h2>
<p>Create a basic Activation Key that uses Library LCE, Default Organization View, and performs auto-attach from the set of all available Subscriptions (i.e. auto-attach=true and no Subscriptions are assigned to the Activation Key).</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">hosts</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">localhost</span>
  <span class="nt">roles</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">role</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">theforeman.foreman.activation_keys</span>
      <span class="nt">vars</span><span class="p">:</span>
        <span class="nt">server_url</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">https://foreman.example.com</span>
        <span class="nt">username</span><span class="p">:</span> <span class="s">&quot;admin&quot;</span>
        <span class="nt">password</span><span class="p">:</span> <span class="s">&quot;changeme&quot;</span>
        <span class="nt">organization</span><span class="p">:</span> <span class="s">&quot;Default</span><span class="nv"> </span><span class="s">Organization&quot;</span>
        <span class="nt">activation_keys</span><span class="p">:</span>
          <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="s">&quot;Basic</span><span class="nv"> </span><span class="s">Activation</span><span class="nv"> </span><span class="s">Key&quot;</span>
            <span class="nt">description</span><span class="p">:</span> <span class="s">&quot;Registers</span><span class="nv"> </span><span class="s">hosts</span><span class="nv"> </span><span class="s">in</span><span class="nv"> </span><span class="s">Library/Default</span><span class="nv"> </span><span class="s">Organization</span><span class="nv"> </span><span class="s">View</span><span class="nv"> </span><span class="s">and</span><span class="nv"> </span><span class="s">tries</span><span class="nv"> </span><span class="s">to</span><span class="nv"> </span><span class="s">attach</span><span class="nv"> </span><span class="s">the</span><span class="nv"> </span><span class="s">best</span><span class="nv"> </span><span class="s">fitting</span><span class="nv"> </span><span class="s">subscription(s)</span><span class="nv"> </span><span class="s">from</span><span class="nv"> </span><span class="s">all</span><span class="nv"> </span><span class="s">available</span><span class="nv"> </span><span class="s">in</span><span class="nv"> </span><span class="s">the</span><span class="nv"> </span><span class="s">organization&quot;</span>
</pre></div>
</div>
<p>Define two Activation Keys. The first registers hosts in the “ACME” organization and attaches the Subscription for the custom product “ACME_App”. The second assigns the “Test” LCE and “RHEL7_Base” Content View, and auto-attaches the best fitting subscription(s) from all which are available in the ACME Organization:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">hosts</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">localhost</span>
  <span class="nt">roles</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">role</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">theforeman.foreman.activation_keys</span>
      <span class="nt">vars</span><span class="p">:</span>
        <span class="nt">server_url</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">https://foreman.example.com</span>
        <span class="nt">username</span><span class="p">:</span> <span class="s">&quot;admin&quot;</span>
        <span class="nt">password</span><span class="p">:</span> <span class="s">&quot;changeme&quot;</span>
        <span class="nt">organization</span><span class="p">:</span> <span class="s">&quot;ACME&quot;</span>
        <span class="nt">activation_keys</span><span class="p">:</span>
          <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="s">&quot;ACME_App_Key&quot;</span>
            <span class="nt">auto_attach</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
            <span class="nt">subscriptions</span><span class="p">:</span>
              <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="s">&quot;ACME_App&quot;</span>
          <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="s">&quot;ACME_RHEL7_Base_Test&quot;</span>
            <span class="nt">lifecycle_environment</span><span class="p">:</span> <span class="s">&quot;Test&quot;</span>
            <span class="nt">content_view</span><span class="p">:</span> <span class="s">&quot;RHEL7_Base&quot;</span>
</pre></div>
</div>
<p>Following the second example, a Host which is registered using <code class="docutils literal notranslate"><span class="pre">subscription-manager</span> <span class="pre">register</span> <span class="pre">--activationkey</span> <span class="pre">ACME_App_Key,ACME_RHEL7_Base_Test</span></code> will get the ACME_App subscription, Test LCE, RHEL7_Base Content View, and auto-attach any additional necessary subscriptions from ACME Organization to cover the Base OS and any other products which require an entitlement certificate.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, The Foreman Project

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>